<!doctype html>
<html>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Open Lyra</title>
  <style>body{font-family:system-ui;margin:24px}</style>
  <h1>Te estamos llevando a Lyra…</h1>
  <p>Si no ocurre nada, toca el botón de abajo o instala la app.</p>
  <p><a id="open" href="#">Abrir en Lyra</a></p>

  <script>
    // Lee el teamId del query string
    const p = new URLSearchParams(location.search);
    const teamId = p.get('teamId') || '';

    // URL de Play Store
    const play = 'https://play.google.com/store/apps/details?id=com.chron.lyra';

    // Intent URI que abre tu esquema nativo (Lyra)
    const intent = `intent://join?teamId=${encodeURIComponent(teamId)}#Intent;scheme=lyra;package=com.chron.lyra;S.browser_fallback_url=${encodeURIComponent(play)};end`;

    // 1) Intenta abrir la app
    location.replace(intent);

    // 2) Botón manual como respaldo
    const btn = document.getElementById('open');
    btn.onclick = (e) => { e.preventDefault(); location.href = intent; };

    // 3) Safety net adicional: si algo bloquea el intent, manda a Play en 1.5s
    setTimeout(() => { if (!document.hidden) location.href = play; }, 1500);
  </script>
</html>
